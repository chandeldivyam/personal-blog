---
import { Image } from 'astro:assets';
import type { ImageMetadata } from 'astro';

export interface Props {
  src: string | ImageMetadata;
  alt: string;
  loading?: 'lazy' | 'eager';
  width?: number;
  height?: number;
}

const { src, alt, loading = 'lazy', width, height } = Astro.props;
const isStringPath = typeof src === 'string';
---

{isStringPath ? (
  <img 
    src={src as string}
    alt={alt}
    loading={loading}
    decoding="async"
    width={width}
    height={height}
    class="optimized-image"
  />
) : (
  <Image 
    src={src as ImageMetadata}
    alt={alt}
    loading={loading}
    decoding="async"
    format="webp"
    quality={80}
    width={width}
    height={height}
    widths={[480, 768, 1200]}
    sizes="(max-width: 768px) 100vw, 42rem"
    class="optimized-image"
  />
)}

<style>
  .optimized-image {
    border-radius: var(--border-radius);
    box-shadow: var(--shadow-sm);
  }
</style>